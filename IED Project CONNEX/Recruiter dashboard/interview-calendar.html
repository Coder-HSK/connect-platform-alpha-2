<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Calendar | CONNEX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="../../Style/Style1.css">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.14/index.global.min.js'></script>
  
</head>
<body class="flex flex-col">

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="logo">
                <h1><a href="../../index.html" class="logo">CONNEX</a></h1>
            </div>
            <ul class="nav-links">
              <li><a href="../Recruiter-dashboard.html" class="btnk-primary">Home</a></li>
              <li><a href="../Recruiter premium.html" class="btnk-primary">Premium</a></li>
            </ul>
            <div class="cta-button">
                <a href="recruiter-account.html" class="btn-primary">Account</a>
            </div>
        </div>
    </nav>
    <main class="flex-grow flex flex-col p-4 md:p-8">
        <div class="w-full max-w-7xl mx-auto">
            
            <header class="text-center text-white mb-6">
                <h1 class="text-3xl md:text-4xl font-bold">Interview Calendar</h1>
                <p class="text-lg text-gray-400 mt-2">Schedule, manage, and view all upcoming interviews.</p>
            </header>

            <div class="flex flex-col md:flex-row justify-between items-center mb-4 p-4 glass-card">
                <div class="flex items-center space-x-2 mb-4 md:mb-0">
                    <button id="btn-prev" class="btn-primary py-2 px-3" title="Previous">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
                    </button>
                    <button id="btn-today" class="btn-primary py-2 px-4 text-sm font-semibold">Today</button>
                    <button id="btn-next" class="btn-primary py-2 px-3" title="Next">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                    </button>
                    
                    <span id="calendar-title" class="text-xl font-semibold text-white ml-4 hidden md:block">Loading...</span>

                    <div class="ml-4">
                        <select id="view-switcher" class="form-input text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2">
                            <option value="dayGridMonth">Month</option>
                            <option value="timeGridWeek" selected>Week</option>
                            <option value="timeGridDay">Day</option>
                        </select>
                    </div>
                </div>

                <div class="flex items-center space-x-2">
                    <input type="text" placeholder="Search by candidate..." class="form-input text-sm rounded-lg p-2 hidden md:block">
                    <select class="form-input text-sm rounded-lg p-2 hidden md:block">
                        <option value="">All Interviewers</option>
                        <option value="jane">Jane Doe</option>
                        <option value="john">John Smith</option>
                    </select>
                    <button id="btn-create" class="btn-primary py-2 px-4 text-sm font-semibold">Create Interview</button>
                </div>
            </div>

            <div class="glass-card p-4">
                <div id="calendar">
                    </div>
            </div>

        </div>
    </main>
    
    <div id="interview-modal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4 hidden">
        <div class="glass-card w-full max-w-lg p-6" style="background: rgba(10, 25, 47, 0.85);">
            <h2 id="modal-title" class="text-2xl font-bold text-white mb-4">Schedule Interview</h2>
            <form id="interview-form">
                <input type="hidden" id="interview-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="candidate-name" class="block text-sm font-medium text-gray-300">Candidate Name</label>
                        <input type="text" id="candidate-name" required class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                        <label for="role-applied" class="block text-sm font-medium text-gray-300">Role Applied For</label>
                        <input type="text" id="role-applied" required class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                        <label for="start-time" class="block text-sm font-medium text-gray-300">Start Time</label>
                        <input type="datetime-local" id="start-time" required class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                        <label for="end-time" class="block text-sm font-medium text-gray-300">End Time</label>
                        <input type="datetime-local" id="end-time" required class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                        <label for="interviewers" class="block text-sm font-medium text-gray-300">Interviewer(s)</label>
                        <input type="text" id="interviewers" placeholder="e.g., Jane Doe, John Smith" class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div>
                        <label for="meeting-mode" class="block text-sm font-medium text-gray-300">Meeting Mode</label>
                        <select id="meeting-mode" class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                            <option>Zoom / Online</option>
                            <option>In-Person</option>
                            <option>Phone</option>
                        </select>
                    </div>
                    <div class="col-span-1 md:col-span-2">
                        <label for="location-link" class="block text-sm font-medium text-gray-300">Location or Meeting Link</label>
                        <input type="text" id="location-link" placeholder="e.g., https://zoom.us/..." class="form-input mt-1 block w-full rounded-md shadow-sm p-2">
                    </div>
                    <div class="col-span-1 md:col-span-2">
                        <label for="notes" class="block text-sm font-medium text-gray-300">Notes / Agenda</label>
                        <textarea id="notes" rows="3" class="form-input mt-1 block w-full rounded-md shadow-sm p-2"></textarea>
                    </div>
                </div>

                <div class="flex justify-between items-center mt-6">
                    <button type="button" id="btn-delete" class="bg-red-600 text-white py-2 px-4 rounded-md font-semibold hover:bg-red-700 hidden">Delete</button>
                    <div class="flex-grow flex justify-end space-x-3">
                        <button type="button" id="btn-cancel" class="bg-gray-600 text-white py-2 px-4 rounded-md font-semibold hover:bg-gray-700">Cancel</button>
                        <button type="submit" id="btn-save" class="btn-primary py-2 px-4 font-semibold">Save</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
      <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>CONNEX</h3>
                    <p>Building bridges between students and professionals.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#how-it-works">How It Works</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Project by:</h4>
                    <ul>
                        <li>Hitendra Annavarapu</li>
                        <li>Mahadi Ibrahim</li>
                        <li>Quin Curry</li>
                        <li>Charan Suguri</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 CONNEX Platform - Alpha 2. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <script>
        // The JavaScript is unchanged, as it was already correct.
        document.addEventListener('DOMContentLoaded', () => {
            const calendarEl = document.getElementById('calendar');
            const modal = document.getElementById('interview-modal');
            const modalTitle = document.getElementById('modal-title');
            const form = document.getElementById('interview-form');
            const interviewIdEl = document.getElementById('interview-id');
            const candidateNameEl = document.getElementById('candidate-name');
            const roleAppliedEl = document.getElementById('role-applied');
            const startTimeEl = document.getElementById('start-time');
            const endTimeEl = document.getElementById('end-time');
            const interviewersEl = document.getElementById('interviewers');
            const meetingModeEl = document.getElementById('meeting-mode');
            const locationLinkEl = document.getElementById('location-link');
            const notesEl = document.getElementById('notes');
            const btnSave = document.getElementById('btn-save');
            const btnCancel = document.getElementById('btn-cancel');
            const btnDelete = document.getElementById('btn-delete');
            const btnCreate = document.getElementById('btn-create');

            const mockEvents = [
                {
                    id: '1',
                    title: 'Alice Johnson - SWE Intern',
                    start: new Date().toISOString().split('T')[0] + 'T10:00:00',
                    end: new Date().toISOString().split('T')[0] + 'T11:00:00',
                    extendedProps: {
                        candidate: 'Alice Johnson',
                        role: 'SWE Intern',
                        interviewers: 'Jane Doe',
                        mode: 'Zoom / Online',
                        location: 'https://zoom.us/j/123456',
                        notes: 'Initial screening.'
                    },
                    backgroundColor: 'var(--fc-event-bg-color)', 
                    borderColor: 'var(--fc-event-border-color)'
                },
                {
                    id: '2',
                    title: 'Bob Smith - PM Intern',
                    start: new Date(new Date().setDate(new Date().getDate() + 1)).toISOString().split('T')[0] + 'T14:30:00',
                    end: new Date(new Date().setDate(new Date().getDate() + 1)).toISOString().split('T')[0] + 'T15:00:00',
                    extendedProps: {
                        candidate: 'Bob Smith',
                        role: 'PM Intern',
                        interviewers: 'John Smith',
                        mode: 'Phone',
                        location: '555-123-4567',
                        notes: 'Phone screen.'
                    },
                    backgroundColor: 'rgba(16, 185, 129, 0.5)', 
                    borderColor: '#10B981'
                }
            ];

            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'timeGridWeek', 
                headerToolbar: false, 
                events: mockEvents,
                editable: true,       
                selectable: true,       
                selectMirror: true,
                dayMaxEvents: true,
                eventOverlap: false,  
                allDaySlot: false, 
                slotMinTime: '08:00:00', 
                slotMaxTime: '19:00:00', 
                height: 'auto', 

                select: (info) => {
                    openModal(info.start, info.end, info.allDay);
                },
                eventClick: (info) => {
                    openModal(info.event.start, info.event.end, info.event.allDay, info.event);
                },
                eventDrop: (info) => {
                    console.log(`Event ${info.event.id} dropped. New start: ${info.event.start}`);
                },
                datesSet: (info) => {
                    document.getElementById('calendar-title').textContent = info.view.title;
                }
            });

            calendar.render();

            document.getElementById('btn-prev').addEventListener('click', () => calendar.prev());
            document.getElementById('btn-today').addEventListener('click', () => calendar.today());
            document.getElementById('btn-next').addEventListener('click', () => calendar.next());
            document.getElementById('view-switcher').addEventListener('change', (e) => {
                calendar.changeView(e.target.value);
            });
            btnCreate.addEventListener('click', () => openModal(new Date()));

            function formatDateTimeLocal(date) {
                if (!date) return '';
                const offset = date.getTimezoneOffset();
                const localDate = new Date(date.getTime() - (offset * 60000));
                return localDate.toISOString().slice(0, 16);
            }

            function openModal(start, end = null, allDay = false, event = null) {
                form.reset();
                if (event) {
                    modalTitle.textContent = 'Edit Interview';
                    btnDelete.classList.remove('hidden');
                    
                    const props = event.extendedProps;
                    interviewIdEl.value = event.id;
                    candidateNameEl.value = props.candidate;
                    roleAppliedEl.value = props.role;
                    startTimeEl.value = formatDateTimeLocal(event.start);
                    endTimeEl.value = formatDateTimeLocal(event.end);
                    interviewersEl.value = props.interviewers;
                    meetingModeEl.value = props.mode;
                    locationLinkEl.value = props.location;
                    notesEl.value = props.notes;

                } else {
                    modalTitle.textContent = 'Schedule Interview';
                    btnDelete.classList.add('hidden');
                    interviewIdEl.value = '';
                    
                    startTimeEl.value = formatDateTimeLocal(start);
                    const defaultEnd = end ? end : new Date(start.getTime() + 60 * 60000);
                    endTimeEl.value = formatDateTimeLocal(defaultEnd);
                }
                modal.classList.remove('hidden');
            }

            function closeModal() {
                modal.classList.add('hidden');
            }

            btnCancel.addEventListener('click', closeModal);

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const isPM = roleAppliedEl.value.toLowerCase().includes('pm');
                
                const eventData = {
                    id: interviewIdEl.value || String(Date.now()), 
                    title: `${candidateNameEl.value} - ${roleAppliedEl.value}`,
                    start: startTimeEl.value,
                    end: endTimeEl.value,
                    extendedProps: {
                        candidate: candidateNameEl.value,
                        role: roleAppliedEl.value,
                        interviewers: interviewersEl.value,
                        mode: meetingModeEl.value,
                        location: locationLinkEl.value,
                        notes: notesEl.value
                    },
                    backgroundColor: isPM ? 'rgba(16, 185, 129, 0.5)' : 'var(--fc-event-bg-color)',
                    borderColor: isPM ? '#10B981' : 'var(--fc-event-border-color)'
                };

                if (interviewIdEl.value) {
                    const existingEvent = calendar.getEventById(eventData.id);
                    if (existingEvent) {
                        existingEvent.remove(); 
                    }
                    calendar.addEvent(eventData); 
                    console.log('Event updated:', eventData);
                } else {
                    calendar.addEvent(eventData);
                    console.log('Event created:', eventData);
                }
                
                closeModal();
            });
            
            btnDelete.addEventListener('click', () => {
                if (confirm('Are you sure you want to delete this interview?')) {
                    const eventId = interviewIdEl.value;
                    const event = calendar.getEventById(eventId);
                    if (event) {
                        event.remove();
                        console.log('Event deleted:', eventId);
                    }
                    closeModal();
                }
            });

        });
    </script>

</body>
</html>